<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Assistente Escolar ‚Äî IA Offline</title>
<style>
  :root{
    --bg:#0b1220; --panel:#0f1724; --muted:#9fb3c8; --accent:#00e5ff;
    --bubble-left:#0f2340; --bubble-right:#06202a; --text:#e6f1ff;
    --card:#0d1622;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Arial;
    background:linear-gradient(180deg,#071018 0%,#071427 60%); color:var(--text);
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }

  /* Layout */
  .app{
    max-width:1100px; margin:28px auto; display:grid; grid-template-columns:320px 1fr; gap:20px;padding:16px;
  }
  @media (max-width:920px){ .app{grid-template-columns:1fr; padding:12px} .sidebar{order:2} }

  /* Sidebar */
  .sidebar{
    background:linear-gradient(180deg,var(--panel),#071020); border-radius:12px; padding:16px; border:1px solid rgba(255,255,255,0.03);
    box-shadow:0 6px 30px rgba(0,0,0,0.6);
  }
  .brand{display:flex; gap:12px; align-items:center; margin-bottom:8px}
  .logo{width:46px;height:46px;border-radius:10px;background:conic-gradient(from 180deg,var(--accent),#00a0c8 40%,#071020 60%); box-shadow:0 6px 20px rgba(0,229,255,0.07)}
  h1{font-size:16px;margin:0}
  .sub{font-size:12px;color:var(--muted); margin-top:6px}

  .section{margin-top:14px}
  .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
  .btn.primary{background:linear-gradient(180deg,var(--accent),#00c3d6); color:#002028}
  .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04); color:var(--text)}

  .chip{display:inline-block;padding:6px 10px;border-radius:999px;background:#071726;color:var(--muted);font-size:13px;margin:6px 6px 0 0;cursor:pointer;border:1px solid rgba(255,255,255,0.02)}

  textarea, input[type="text"], select{
    width:100%; background:#071426;border:1px solid rgba(255,255,255,0.03); color:var(--text);
    padding:10px;border-radius:10px;font-size:14px;margin-top:8px;
  }

  label{font-size:13px;color:var(--muted)}

  /* Chat panel */
  .panel{
    background:linear-gradient(180deg,#071428 0%,#081824 100%); border-radius:12px; padding:14px; min-height:540px; display:flex; flex-direction:column;
    border:1px solid rgba(255,255,255,0.03);
  }
  .panel-header{display:flex;align-items:center;justify-content:space-between}
  .panel-title{display:flex;gap:12px;align-items:center}
  .ai-dot{width:12px;height:12px;border-radius:99px;background:linear-gradient(180deg,var(--accent),#00a37c);box-shadow:0 6px 18px rgba(0,229,255,0.1)}
  .status{font-size:13px;color:var(--muted)}

  .chat{
    margin-top:12px; flex:1; overflow:auto; padding-right:6px;
  }
  .msg{display:flex; gap:12px; margin-bottom:12px; align-items:flex-end}
  .avatar{width:36px;height:36px;border-radius:8px;background:#071726;display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--accent);font-size:15px}
  .bubble{max-width:78%; padding:12px 14px;border-radius:12px; line-height:1.45; font-size:14px}
  .left .bubble{background:var(--bubble-left); border:1px solid rgba(255,255,255,0.02); border-bottom-left-radius:6px}
  .right{justify-content:flex-end}
  .right .bubble{background:linear-gradient(180deg,var(--bubble-right),#06323b); border:1px solid rgba(0,0,0,0.25); color:#dff7ef; border-bottom-right-radius:6px}

  .controls{display:flex; gap:8px; margin-top:12px; align-items:center}
  .input{flex:1; display:flex; gap:8px; align-items:center}
  .input input{flex:1; padding:12px;border-radius:10px}
  .send{padding:10px 14px;border-radius:10px; background:var(--accent); color:#002028; border:none; font-weight:700; cursor:pointer}

  .hint{font-size:13px;color:var(--muted); margin-top:8px}

  /* small helpers */
  .small{font-size:13px;color:var(--muted)}
  pre{background:#061021;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02);overflow:auto}
</style>
</head>
<body>

<div class="app">
  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="brand">
      <div class="logo"></div>
      <div>
        <h1>Assistente Escolar</h1>
        <div class="sub">Dica: Fa√ßa perguntas simples!</div>
      </div>
    </div>

    <div class="section">
      <label>Carregar modelo de comunicado (opcional)</label>
      <textarea id="comunicadoInput" rows="6" placeholder="Cole o comunicado aqui (opcional) ‚Äî ser√° usado s√≥ se necess√°rio"></textarea>
      <div style="display:flex; gap:8px; margin-top:8px;">
        <button class="btn primary" id="loadSample">Carregar Comunicado Exemplo</button>
        <button class="btn ghost" id="clearCom">Limpar</button>
      </div>
      <div class="small" style="margin-top:8px">Se n√£o colar nada, a IA responde com gen√©ricos escolares.</div>
    </div>

    <div class="section">
      <label>Respostas r√°pidas</label>
      <div>
        <span class="chip" data-q="Qual o hor√°rio do evento?">Qual hor√°rio?</span>
        <span class="chip" data-q="Vai ter transporte para o passeio?">Transporte</span>
        <span class="chip" data-q="Precisa levar uniforme?">Uniforme</span>
        <span class="chip" data-q="Quando √© a viagem acad√™mica?">Viagem</span>
        <span class="chip" data-q="Faz um cronograma de estudos de 1 semana para a viagem">Cronograma</span>
      </div>
    </div>

    <div class="section">
      <label>Prefer√™ncias</label>
      <select id="schoolType">
        <option value="fundamental">Ensino Fundamental</option>
        <option value="medio">Ensino M√©dio</option>
        <option value="tecnico">Ensino T√©cnico</option>
      </select>
      <div class="hint">Tom das respostas ajustado pro tipo de escola.</div>
    </div>

    <div class="section" style="margin-top:18px">
      <label>Modo</label>
      <div style="display:flex; gap:8px; margin-top:8px">
        <button class="btn ghost" id="modeGen">Respostas Gen√©ricas</button>
        <button class="btn ghost" id="modeUseCom">Usar Comunicado (se houver)</button>
      </div>
      <div class="small" style="margin-top:8px">Modo padr√£o: gen√©rico. Use comunicado s√≥ se quiser respostas espec√≠ficas.</div>
    </div>

    <!-- NOVA SE√á√ÉO COM BOT√ÉO PARA A P√ÅGINA DE FUNCIONALIDADES -->
    <div class="section" style="margin-top:24px; border-top:1px solid rgba(255,255,255,0.05); padding-top:16px">
      <label>Documenta√ß√£o</label>
      <div style="display:flex; gap:8px; margin-top:8px">
        <button class="btn ghost" id="docBtn" style="flex:1; justify-content:center">
          üìö Ver Tudo que a IA Faz
        </button>
      </div>
      <div class="small" style="margin-top:8px">Descubra todas as funcionalidades e capacidades deste assistente.</div>
    </div>

  </aside>

  <!-- CHAT PANEL -->
  <main class="panel" role="main" aria-live="polite">
    <div class="panel-header">
      <div class="panel-title">
        <div class="ai-dot" aria-hidden="true"></div>
        <div>
          <div style="font-weight:700">Assistente Escolar ‚Äî Offline</div>
          <div class="status small">Respostas r√°pidas e objetivas off-line </div>
        </div>
      </div>
      <div class="small">Modelo local ‚Ä¢ Gen√©ricos escolares</div>
    </div>

    <div class="chat" id="chat"></div>

    <div class="controls">
      <div class="input">
        <input id="userInput" type="text" placeholder="Pergunta sobre comunicado / evento / cronograma (ex.: 'Qual o hor√°rio do evento?')" />
        <button class="send" id="sendBtn">Enviar</button>
      </div>
      <div style="display:flex; gap:8px; align-items:center;">
        <button class="btn ghost" id="resetChat">‚Ü∫ Limpar</button>
      </div>
    </div>
    <div style="margin-top:10px" class="hint">DICA: use perguntas curtas. Ex.: "Hor√°rio da Feira?" / "Cronograma 3 dias viagem".</div>
  </main>
</div>

<script>
/* ========= Dados e utilit√°rios ========= */
const chatEl = document.getElementById('chat');
const input = document.getElementById('userInput');
const sendBtn = document.getElementById('sendBtn');
const loadSample = document.getElementById('loadSample');
const clearCom = document.getElementById('clearCom');
const comunicadoInput = document.getElementById('comunicadoInput');
const chips = document.querySelectorAll('.chip');
const modeUseComBtn = document.getElementById('modeUseCom');
const modeGenBtn = document.getElementById('modeGen');
const schoolType = document.getElementById('schoolType');
const resetChat = document.getElementById('resetChat');
const docBtn = document.getElementById('docBtn'); // Novo bot√£o

let useComunicado = false; // por padr√£o respostas gen√©ricas

const sampleComunicado = `Feira das Universidades: 18/09/2025, 8h-18h. 
Viagem Acad√™mica (Grade 4-6): embarque 04/10/2025 √†s 4h30 para UBAJARA-CE. 
Semana da Crian√ßa: 06/10 a 10/10 - programa√ß√£o interna. 
Sa√≠da e transporte: pais s√£o respons√°veis pelo transporte salvo onde informado transporte coletivo pela escola. 
Uniforme: uso do uniforme escolar √© obrigat√≥rio em eventos esportivos.`;

function appendMessage(side, html){
  const wrap = document.createElement('div');
  wrap.className = 'msg ' + (side === 'user' ? 'right' : 'left');
  const avatar = document.createElement('div'); avatar.className='avatar';
  avatar.textContent = side === 'user' ? 'TU' : 'AS';
  const bubble = document.createElement('div'); bubble.className='bubble';
  bubble.innerHTML = html;
  if(side === 'user'){
    wrap.appendChild(bubble); wrap.appendChild(avatar);
  } else {
    wrap.appendChild(avatar); wrap.appendChild(bubble);
  }
  chatEl.appendChild(wrap);
  chatEl.scrollTop = chatEl.scrollHeight;
}

/* ========= Motor de respostas (offline, gen√©rico) ========= */

function respondTo(question){
  const q = question.trim().toLowerCase();

  // 1) Detec√ß√£o cronograma requests: "cronograma", "agenda", "plano"
  if(/cronogram|cronograma|agenda|plano de|programa(√ß|c)√£o|itiner√°rio/.test(q)){
    return gerarCronograma(q);
  }

  // 2) Datas / hor√°rio
  if(/hor[r√°]rio|que horas|quando come√ßa|quando √© a feira|qual o hor√°rio|que horas come√ßa/.test(q)){
    return responderHorario(q);
  }

  // 3) Local / onde
  if(/onde|local|localiza|endere√ßo|onde ser√°|onde fica/.test(q)){
    return "Normalmente os eventos acontecem na escola (p√°tio ou gin√°sio). Consulte o comunicado oficial para confirma√ß√£o do local. Se n√£o houver informa√ß√£o, confirme com a coordena√ß√£o.";
  }

  // 4) Transporte
  if(/transporte|√¥nibus|onibus|van|carro|vai ter transporte|bus|van/.test(q)){
    return "Transporte: regra geral, pais s√£o respons√°veis pelo deslocamento, salvo quando o comunicado informar transporte escolar. Confirme no comunicado/coordena√ß√£o.";
  }

  // 5) Uniforme / traje
  if(/uniform|traje|vestir|roupa|uniforme|roupas/.test(q)){
    return "Uniforme: em atividades esportivas e cerim√¥nias o uso do uniforme completo costuma ser obrigat√≥rio. Verifique o comunicado espec√≠fico para exce√ß√µes.";
  }

  // 6) Inscri√ß√µes / confirma√ß√£o presen√ßa / links
  if(/inscr|confirmar|presen|inscrev|link|formul[a√°]rio/.test(q)){
    return "Inscri√ß√µes/Confirma√ß√£o: quando for obrigat√≥rio haver√° um link/formul√°rio. Se n√£o houver link no comunicado, contate a secretaria/coordena√ß√£o para confirma√ß√£o.";
  }

  // 7) Regras / responsabilidade dos pais
  if(/responsa|pais|respons[a√°]vel|chegar|pontualidade|pontual/.test(q)){
    return "Responsabilidade: pais/resp. s√£o respons√°veis por levar/buscar os alunos e garantir que cheguem no hor√°rio. Pontualidade √© exigida.";
  }

  // 8) Semana da crian√ßa / programa√ß√£o
  if(/semana da crian√ßa|children's week|magical games/.test(question.toLowerCase())){
    return "Semana da Crian√ßa: programa√ß√£o interna com atividades tem√°ticas (ex.: Dia da Corda, Bambol√™, Brincadeiras de rua). Veja as cores do dia no comunicado.";
  }

  // 9) Provas / avalia√ß√µes / enunciados ‚Äî bloqueado (s√≥ resposta gen√©rica)
  if(/prova|enem|avalia√ß|avaliac|simulado|bq|bimestre/.test(q)){
    return "Sobre avalia√ß√µes: consulte o comunicado oficial ou coordena√ß√£o. Este assistente n√£o fornece conte√∫dos ou quest√µes ‚Äî apenas informa√ß√µes log√≠sticas e cronogramas.";
  }

  // 10) Perguntas sobre viagem acad√™mica espec√≠ficas de datas
  if(/viagem|embarque|uberaja|ubajara|ubajara|ubajara-cear[a√°]/.test(q)){
    // se comunicado tiver info, usar: (modoUseComunicado)
    if(useComunicado && comunicadoInput.value.trim()){
      // tenta extrair data do comunicado simples (procura por padr√£o dd/mm/aaaa)
      const dt = extractFirstDateFromText(comunicadoInput.value);
      if(dt) return `Viagem acad√™mica: embarque detectado em ${dt}. Consulte a coordena√ß√£o para detalhes (hor√°rio exato, ponto de encontro e instru√ß√µes).`;
    }
    return "Viagem acad√™mica: embarque e instru√ß√µes s√£o passadas no comunicado. Geralmente h√° hora de sa√≠da cedo (ex.: 4h30) e informa√ß√£o sobre ponto de encontro.";
  }

  // 11) Se nada casou, responde gen√©rico e oferece op√ß√µes
  return `Infelizmente eu n√£o tenho essa informa√ß√£o. Eu posso responder perguntas do tipo:
  ‚Ä¢ Responder hor√°rio padr√£o (ex.: "8h √†s 18h"),
  ‚Ä¢ Dizer se precisa uniforme,
  ‚Ä¢ Gerar um cronograma r√°pido.
  Se mesmo assim voc√™ n√£o conseguir aperte no bot√£o Tudo que a ia faz!`;
}

/* ====== Fun√ß√µes auxiliares de resposta ====== */

function responderHorario(q){
  // tenta achar hor√°rio em comunicado se modo usar comunicado
  if(useComunicado && comunicadoInput.value.trim()){
    const times = extractTimesFromText(comunicadoInput.value);
    if(times.length){
      return `Hor√°rios detectados no comunicado: ${[...new Set(times)].join(', ')}.`;
    }
  }
  // heur√≠stica por palavras
  if(/feira|fair|universit/i.test(q)) return "Feira: geralmente 8h √†s 18h (verifique o comunicado).";
  if(/viagem|embarque/i.test(q)) return "Viagem: sa√≠da costuma ser bem cedo (ex.: 4h30). Confirme no comunicado.";
  if(/children|semana da crian√ßa|child/i.test(q)) return "Atividades da Semana da Crian√ßa ocorrem durante o hor√°rio escolar (manh√£ e/ou tarde) conforme calend√°rio do segmento.";
  return "Hor√°rio padr√£o: verifique o comunicado. Se quiser eu gero um lembrete gen√©rico pro dia do evento.";
}

function gerarCronograma(q){
  // tenta extrair n√∫mero de dias
  const diasMatch = q.match(/(\d+)\s*dia/);
  let dias = diasMatch ? parseInt(diasMatch[1]) : 3;
  if (dias > 7) dias = 7;
  // base pros turnos e itens
  const tipo = schoolType.value; // pode ajustar linguagem
  const template = [];
  for(let d=1; d<=dias; d++){
    template.push({
      dia: `Dia ${d}`,
      atividades: [
        "07:00 - Sa√≠da / encontro (confirmar ponto)",
        "09:00 - Atividade pedag√≥gica / visita monitorada",
        "12:00 - Almo√ßo / descanso (trazer lanche ou refei√ß√£o conforme comunicado)",
        "14:00 - Oficina / atividade pr√°tica",
        "16:00 - Retorno / devolu√ß√£o aos pais"
      ]
    });
  }
  // resposta compacta
  let resp = `Cronograma r√°pido (${dias} dia${dias>1?'s':''}) ‚Äî tom: ${tipo}:\n\n`;
  template.forEach(t=>{
    resp += `${t.dia}\n`;
    t.atividades.forEach(a=> resp += ` ‚Ä¢ ${a}\n`);
    resp += `\n`;
  });
  resp += "Obs: ajuste hor√°rios conforme comunicado/coordena√ß√£o.";
  return resp;
}

/* ====== Extra√ß√£o simples de datas/horas (heur√≠stica) ====== */
function extractFirstDateFromText(text){
  // procura dd/mm/aaaa ou dd/mm/aa
  const m = text.match(/(\b\d{1,2}\/\d{1,2}\/\d{2,4}\b)/);
  return m ? m[1] : null;
}
function extractTimesFromText(text){
  const arr = [];
  const rx = /(\b\d{1,2}h(?:\d{2})?|\b\d{1,2}:\d{2}\b)/g;
  let mm;
  while((mm = rx.exec(text)) !== null) arr.push(mm[1]);
  return arr;
}

/* ========= Eventos UI ========= */

sendBtn.addEventListener('click', ()=> {
  const val = input.value.trim();
  if(!val) return;
  appendMessage('user', escapeHtml(val));
  input.value = '';
  // Simula "pensamento" curto
  setTimeout(()=> {
    const answer = respondTo(val);
    appendMessage('bot', formatAnswer(answer));
  }, 350 + Math.random()*300);
});

input.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter' && !e.shiftKey){ e.preventDefault(); sendBtn.click(); }
});

loadSample.addEventListener('click', ()=>{
  comunicadoInput.value = sampleComunicado;
  toast("Comunicado de exemplo carregado.");
});

clearCom.addEventListener('click', ()=>{
  comunicadoInput.value = '';
  toast("Comunicado limpo.");
});

chips.forEach(c=>{
  c.addEventListener('click', ()=>{
    const q = c.dataset.question;
    input.value = q;
    input.focus();
  });
});

modeUseComBtn.addEventListener('click', ()=>{
  useComunicado = true;
  modeUseComBtn.classList.add('primary');
  modeGenBtn.classList.remove('primary');
  toast("Modo: usar comunicado (quando presente).");
});
modeGenBtn.addEventListener('click', ()=>{
  useComunicado = false;
  modeGenBtn.classList.add('primary');
  modeUseComBtn.classList.remove('primary');
  toast("Modo: respostas gen√©ricas.");
});
modeGenBtn.classList.add('primary'); // default

resetChat.addEventListener('click', ()=>{
  chatEl.innerHTML = '';
  appendWelcome();
});

// NOVO EVENTO PARA O BOT√ÉO DE DOCUMENTA√á√ÉO
docBtn.addEventListener('click', ()=>{
  window.location.href = 'tudoqueaiafaz.html';
});

/* ========= Helpers e inicializa√ß√£o ======= */

function escapeHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
function formatAnswer(ans){
  // se for string com quebras, mant√©m formata√ß√£o
  return `<div style="white-space:pre-wrap">${escapeHtml(ans)}</div>`;
}

function toast(msg){
  // simples notifica√ß√£o no painel (n√£o intrusiva)
  const t = document.createElement('div');
  t.className='message';
  t.style.cssText='position:fixed;right:18px;bottom:18px;background:#071726;color:var(--muted);padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)';
  t.textContent = msg;
  document.body.appendChild(t);
  setTimeout(()=> t.remove(),1800);
}

function appendWelcome(){
  appendMessage('bot', "T√° aqui ‚Äî pergunta na lata: hor√°rios, transporte, uniforme, inscri√ß√µes e cronogramas. Sem conte√∫do de prova. Ex.: 'Qual o hor√°rio da feira?' / 'Gerar cronograma 3 dias viagem'.");
}
appendWelcome();

</script>
</body>

</html
